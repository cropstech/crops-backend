{
  "serviceName": "crops-backend",
  "containers": {
    "web": {
      "image": ":crops-backend.web.latest",
      "ports": {
        "8000": "HTTP"
      },
      "environment": {
        "DJANGO_SETTINGS_MODULE": "crops.settings_production",
        "DATABASE_URL": "${DATABASE_URL}",
        "SECRET_KEY": "${SECRET_KEY}",

        "AWS_ACCESS_KEY_ID": "${AWS_ACCESS_KEY_ID}",
        "AWS_SECRET_ACCESS_KEY": "${AWS_SECRET_ACCESS_KEY}",
        "S3_ACCESS_KEY_ID": "${S3_ACCESS_KEY_ID}",
        "S3_SECRET_ACCESS_KEY": "${S3_SECRET_ACCESS_KEY}",
        "AWS_STORAGE_BUCKET_NAME": "${AWS_STORAGE_BUCKET_NAME}",
        "AWS_STORAGE_CDN_BUCKET_NAME": "${AWS_STORAGE_CDN_BUCKET_NAME}",
        "AWS_S3_LOCATION": "${AWS_S3_LOCATION}",
        "AWS_S3_CUSTOM_DOMAIN": "${AWS_S3_CUSTOM_DOMAIN}",

        "AWS_SES_ACCESS_KEY_ID": "${AWS_SES_ACCESS_KEY_ID}",
        "AWS_SES_SECRET_ACCESS_KEY": "${AWS_SES_SECRET_ACCESS_KEY}",
        "AWS_SES_REGION_NAME": "${AWS_SES_REGION_NAME}",

        "ALLOWED_HOSTS": "${ALLOWED_HOSTS}",
        "CORS_ALLOWED_ORIGINS": "${CORS_ALLOWED_ORIGINS}",
        "CSRF_TRUSTED_ORIGINS": "${CSRF_TRUSTED_ORIGINS}",
        "FRONTEND_URL": "${FRONTEND_URL}",
        "WEBHOOK_BASE_URL": "${WEBHOOK_BASE_URL}",
        "ASSET_CHECKER_API_URL": "${ASSET_CHECKER_API_URL}",
        "LAMBDA_AUTH_TOKEN": "${LAMBDA_AUTH_TOKEN}",
        "SECURE_SSL_REDIRECT": "${SECURE_SSL_REDIRECT}"
      },
      "command": [
        "gunicorn",
        "--bind",
        "0.0.0.0:8000",
        "--workers",
        "1",
        "--timeout",
        "120",
        "--max-requests",
        "0",
        "--log-level",
        "debug",
        "--access-logfile",
        "-",
        "--error-logfile",
        "-",
        "--preload",
        "crops.wsgi:application"
      ]
    }
  },
  "publicEndpoint": {
    "containerName": "web",
    "containerPort": 8000,
    "healthCheck": {
      "healthyThreshold": 2,
      "unhealthyThreshold": 2,
      "timeoutSeconds": 5,
      "intervalSeconds": 30,
      "path": "/admin",
      "successCodes": "200-499"
    }
  }
}


